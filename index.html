<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CC扫描 - 系统安全检测</title>
    <style>
        body{font-family:'Segoe UI',Arial,sans-serif;background-color:#f0f0f0;margin:0;padding:0;color:#333}
        .scanner-container{width:80%;max-width:800px;margin:50px auto;background-color:white;border-radius:5px;box-shadow:0 0 15px rgba(0,0,0,0.1);padding:20px;overflow:hidden;position:relative}
        .header{background-color:#3498db;color:white;padding:15px;margin:-20px -20px 20px -20px;display:flex;align-items:center}
        .header img{height:30px;margin-right:10px}
        .progress-container{margin:20px 0}
        .progress-bar{height:20px;background-color:#ecf0f1;border-radius:10px;overflow:hidden}
        .progress{height:100%;width:0%;background-color:#3498db;transition:width 0.3s}
        .scan-details{margin-top:20px;border-top:1px solid #eee;padding-top:20px;max-height:300px;overflow-y:auto}
        .file-item{padding:8px 0;border-bottom:1px solid #f5f5f5;display:flex;justify-content:space-between}
        .virus-found{color:#e74c3c;font-weight:bold}
        .virus-cleaned{color:#2ecc71;font-weight:bold}
        .btn{background-color:#3498db;color:white;border:none;padding:10px 20px;border-radius:5px;cursor:pointer;font-size:16px;margin-top:20px}
        .btn-danger{background-color:#e74c3c}
        .btn-success{background-color:#2ecc71}
        .btn-warning{background-color:#f39c12}
        .loading{display:inline-block;width:20px;height:20px;border:3px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#fff;animation:spin 1s ease-in-out infinite}
        @keyframes spin{to{transform:rotate(360deg)}}
        .alert{padding:15px;border-radius:5px;margin:20px 0;border:1px solid transparent}
        .alert-danger{background-color:#f8d7da;color:#721c24;border-color:#f5c6cb}
        .alert-info{background-color:#d1ecf1;color:#0c5460;border-color:#bee5eb}
        .alert-success{background-color:#d4edda;color:#155724;border-color:#c3e6cb}
        .alert-warning{background-color:#fff3cd;color:#856404;border-color:#ffeeba}
        .ccnb-required{display:none;text-align:center;padding:20px}
        .ccnb-logo{width:100px;height:100px;margin:20px auto;background-color:#2ecc71;border-radius:20px;display:flex;align-items:center;justify-content:center;color:white;font-size:24px;font-weight:bold}
        .system-clean{text-align:center;padding:20px;color:#2ecc71;font-size:18px}
        .refresh-message{text-align:center;padding:15px;margin:20px 0;background-color:#f8f9fa;border-radius:5px;border:1px solid #ddd}
        .key-input{margin:15px 0;padding:10px;width:100%;border:1px solid #ddd;border-radius:4px}
        .settings-btn{position:absolute;top:20px;right:20px;background:transparent;border:none;color:#7f8c8d;cursor:pointer;font-size:24px}
        .settings-menu{display:none;position:absolute;top:50px;right:20px;background:white;border-radius:5px;box-shadow:0 0 10px rgba(0,0,0,0.1);padding:10px;z-index:100}
        .settings-menu button{display:block;width:100%;padding:8px 12px;text-align:left;background:none;border:none;cursor:pointer}
        .settings-menu button:hover{background-color:#f5f5f5}
    </style>
</head>
<body>
    <div class="scanner-container" id="scanner-ui">
        <button class="settings-btn" id="settings-btn">⚙️</button>
        <div class="settings-menu" id="settings-menu">
            <button id="clear-data-btn">清除所有使用信息</button>
        </div>

        <div class="header">
            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSJ3aGl0ZSIgZD0iTTI1NiA4QzExOSA4IDggMTE5IDggMjU2czExMSAyNDggMjQ4IDI0OCAyNDgtMTExIDI0OC0yNDhTMzkzIDggMjU2IDh6bTAgNDQ4Yy0xMTAuNSAwLTIwMC04OS41LTIwMC0yMDBTMTQ1LjUgNTYgMjU2IDU2czIwMCA4OS41IDIwMCAyMDAtODkuNSAyMDAtMjAwIDIwMHptMzMuOC0zMTkuNGMtMTAuMi0xMC4yLTI3LTEwLjItMzcuMiAwTDE2MCAzNTguN2wtMjguOC0yOC44Yy0xMC4yLTEwLjItMjctMTAuMi0zNy4yIDAtMTAuMiAxMC4yLTEwLjIgMjcgMCAzNy4ybDU2LjQgNTYuNGM1LjEgNS4xIDExLjggNy44IDE4LjkgNy44czEzLjgtMi43IDE4LjktNy44bDEyOC0xMjljMTAuMi0xMC4yIDEwLjItMjcgMC0zNy4yeiIvPjwvc3ZnPg==" alt="Shield">
            <h2>CC扫描 - 系统安全检测</h2>
        </div>

        <div class="progress-container">
            <p>正在分析您的系统安全性...</p>
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
            <p id="status-text">准备扫描...</p>
        </div>

        <div class="alert alert-danger" id="critical-alert" style="display:none">
            <h3>⚠️ 安全警报！</h3>
            <p id="alert-text">检测到多个高危安全威胁！系统完整性可能受损！</p>
        </div>

        <div class="alert alert-success" id="clean-alert" style="display:none">
            <h3>✓ 系统安全</h3>
            <p>未检测到安全威胁，您的系统是安全的。</p>
        </div>

        <div class="alert alert-warning" id="reset-alert" style="display:none">
            <h3>信息已清除</h3>
            <p>所有使用信息已成功清除，请刷新页面。</p>
        </div>

        <div class="scan-details" id="scan-details"></div>
        <div class="system-clean" id="system-clean" style="display:none">
            <p>您的系统已经过全面扫描，未发现任何安全威胁。</p>
        </div>

        <div class="alert alert-info" id="ccnb-required" style="display:none">
            <h3>需要 CCNB 安全核心</h3>
            <p>检测到您的系统缺少必要的安全组件。要修复这些威胁，必须安装 CCNB 安全核心。</p>
            <div class="ccnb-logo">CCNB</div>
            <p>CCNB 安全核心提供实时防护和高级威胁清除功能。</p>
            <input type="password" class="key-input" id="activation-key" placeholder="请输入激活密钥">
            <button class="btn btn-success" id="install-ccnb">立即安装 CCNB</button>
            <p style="font-size:12px;color:#777">未安装 CCNB 将无法使用完整安全功能</p>
        </div>

        <div class="refresh-message" id="refresh-message" style="display:none">
            <p>CCNB 已成功安装！请刷新网页后即可继续操作。</p>
        </div>

        <button class="btn" id="start-btn">开始扫描</button>
        <button class="btn btn-danger" id="fix-btn" style="display:none">立即修复威胁</button>
        <button class="btn" id="rescan-btn" style="display:none">重新扫描</button>
        <button class="btn btn-warning" id="reset-btn" style="display:none">清除使用信息</button>
    </div>

    <div class="scanner-container" id="ccnb-installer" style="display:none">
        <div class="header" style="background-color:#2ecc71">
            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZmlsbD0id2hpdGUiIGQ9Ik0xMiwyQTEwLDEwIDAgMCwwIDIsMTJBMTAsMTAgMCAwLDAgMTIsMjJBMTAsMTAgMCAwLDAgMjIsMTJBMTAsMTAgMCAwLDAgMTIsMk0xMCwxN0wxNSwxMkwxMCw3VjE3WiIgLz48L3N2Zz4=" alt="CCNB Logo">
            <h2>CCNB 安全核心安装</h2>
        </div>

        <div class="alert alert-info">
            <h3>正在安装 CCNB 安全核心</h3>
            <p>此过程可能需要几分钟时间，请勿关闭窗口。</p>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress" id="ccnb-progress"></div>
            </div>
            <p id="ccnb-status-text">准备安装...</p>
        </div>

        <div id="ccnb-file-progress"></div>
        <button class="btn btn-success" id="ccnb-complete-btn" style="display:none">完成安装</button>
    </div>

    <script>
        const hasInstalledCCNB=localStorage.getItem('ccnbInstalled')==='true';
        const hasFixedThreats=localStorage.getItem('threatsFixed')==='true';
        const files=["系统核心/kernel32.dll","程序文件/system.dll","用户文档/财务报告.xlsx","下载/game_mod.exe","系统驱动/network.sys","启动项/startup.dll","图片/证件照.jpg","音乐/个人录音.mp3","系统配置/SYSTEM","桌面/重要文件.doc"];
        const threats=["Trojan.Generic","Backdoor.Bladabindi","Exploit.LSASS","Vulnerability.CVE-2023","Ransomware.Cry","Spyware.Keylogger","Adware.Popup","Virus.Neshta","Worm.Network","Rootkit.TDSS"];
        const ccnbFiles=["CCNB_Core.sys","CCNB_Security.exe","ThreatDefinitions.db","RealTimeProtection.dll","FirewallEngine.exe","UI_Components","Configuration","ResourcePack"];
        const CORRECT_KEY="198245";

        const startBtn=document.getElementById('start-btn');
        const fixBtn=document.getElementById('fix-btn');
        const rescanBtn=document.getElementById('rescan-btn');
        const resetBtn=document.getElementById('reset-btn');
        const installCcnbBtn=document.getElementById('install-ccnb');
        const ccnbCompleteBtn=document.getElementById('ccnb-complete-btn');
        const progress=document.getElementById('progress');
        const ccnbProgress=document.getElementById('ccnb-progress');
        const statusText=document.getElementById('status-text');
        const ccnbStatusText=document.getElementById('ccnb-status-text');
        const scanDetails=document.getElementById('scan-details');
        const ccnbFileProgress=document.getElementById('ccnb-file-progress');
        const criticalAlert=document.getElementById('critical-alert');
        const cleanAlert=document.getElementById('clean-alert');
        const resetAlert=document.getElementById('reset-alert');
        const systemClean=document.getElementById('system-clean');
        const refreshMessage=document.getElementById('refresh-message');
        const alertText=document.getElementById('alert-text');
        const ccnbRequired=document.getElementById('ccnb-required');
        const scannerUI=document.getElementById('scanner-ui');
        const ccnbInstaller=document.getElementById('ccnb-installer');
        const activationKey=document.getElementById('activation-key');
        const settingsBtn=document.getElementById('settings-btn');
        const settingsMenu=document.getElementById('settings-menu');
        const clearDataBtn=document.getElementById('clear-data-btn');

        function initUI(){
            criticalAlert.style.display='none';
            cleanAlert.style.display='none';
            resetAlert.style.display='none';
            systemClean.style.display='none';
            ccnbRequired.style.display='none';
            refreshMessage.style.display='none';
            scanDetails.innerHTML='';
            if(hasInstalledCCNB){
                if(hasFixedThreats){
                    systemClean.style.display='block';
                    cleanAlert.style.display='block';
                    rescanBtn.style.display='inline-block';
                    startBtn.style.display='none';
                    fixBtn.style.display='none';
                    resetBtn.style.display='inline-block';
                }else{
                    startBtn.style.display='inline-block';
                    fixBtn.style.display='none';
                    rescanBtn.style.display='none';
                    resetBtn.style.display='inline-block';
                }
            }else{
                startBtn.style.display='inline-block';
                fixBtn.style.display='none';
                rescanBtn.style.display='none';
                resetBtn.style.display='none';
            }
        }

        initUI();

        settingsBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            settingsMenu.style.display = settingsMenu.style.display === 'block' ? 'none' : 'block';
        });

        document.addEventListener('click', function() {
            settingsMenu.style.display = 'none';
        });

        clearDataBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            clearUserData();
            settingsMenu.style.display = 'none';
        });

        resetBtn.addEventListener('click', function() {
            clearUserData();
        });

        function clearUserData() {
            try {
                localStorage.removeItem('ccnbInstalled');
                localStorage.removeItem('threatsFixed');
                
                resetAlert.style.display='block';
                criticalAlert.style.display='none';
                cleanAlert.style.display='none';
                systemClean.style.display='none';
                ccnbRequired.style.display='none';
                refreshMessage.style.display='none';
                scanDetails.innerHTML='';
                startBtn.style.display='inline-block';
                fixBtn.style.display='none';
                rescanBtn.style.display='none';
                resetBtn.style.display='none';
                
            } catch (error) {
                alert('清除失败: ' + error.message);
            }
        }

        startBtn.addEventListener('click',startScan);
        fixBtn.addEventListener('click',fixThreats);
        rescanBtn.addEventListener('click',startScan);
        installCcnbBtn.addEventListener('click',installCCNB);
        ccnbCompleteBtn.addEventListener('click',completeCCNBInstallation);

        function startScan(){
            startBtn.disabled=true;
            rescanBtn.disabled=true;
            startBtn.innerHTML='<span class="loading"></span> 扫描中...';
            criticalAlert.style.display='none';
            cleanAlert.style.display='none';
            resetAlert.style.display='none';
            systemClean.style.display='none';
            ccnbRequired.style.display='none';
            refreshMessage.style.display='none';
            scanDetails.innerHTML='';
            fixBtn.style.display='none';
            rescanBtn.style.display='none';
            resetBtn.style.display='none';
            let progressValue=0;
            const interval=setInterval(()=>{
                progressValue+=Math.random()*5;
                if(progressValue>100)progressValue=100;
                progress.style.width=progressValue+'%';
                if(progressValue<30){
                    statusText.textContent="扫描系统核心组件...";
                }else if(progressValue<60){
                    statusText.textContent="检查用户文件...";
                }else if(progressValue<90){
                    statusText.textContent="分析潜在威胁...";
                }else{
                    statusText.textContent="完成安全检查...";
                }
                if(!hasFixedThreats&&progressValue>20&&progressValue<90&&Math.random()>0.7){
                    addScanResult(false);
                }
                if(progressValue===100){
                    clearInterval(interval);
                    completeScan();
                }
            },300);
        }

        function addScanResult(isCleaned){
            const isThreat=!hasFixedThreats&&Math.random()>0.4;
            const randomFile=files[Math.floor(Math.random()*files.length)];
            const randomThreat=threats[Math.floor(Math.random()*threats.length)];
            const item=document.createElement('div');
            item.className='file-item';
            if(isThreat){
                if(isCleaned){
                    item.innerHTML=`<span>${randomFile}</span><span class="virus-cleaned">${randomThreat} 已清除!</span>`;
                }else{
                    item.innerHTML=`<span>${randomFile}</span><span class="virus-found">${randomThreat} 检测到!</span>`;
                }
            }else{
                item.innerHTML=`<span>${randomFile}</span><span>安全</span>`;
            }
            scanDetails.appendChild(item);
            scanDetails.scrollTop=scanDetails.scrollHeight;
        }

        function completeScan(){
            statusText.textContent="扫描完成！";
            if(hasFixedThreats){
                cleanAlert.style.display='block';
                systemClean.style.display='block';
                rescanBtn.style.display='inline-block';
                rescanBtn.disabled=false;
                resetBtn.style.display='inline-block';
                scanDetails.innerHTML='';
                for(let i=0;i<files.length;i++){
                    const item=document.createElement('div');
                    item.className='file-item';
                    item.innerHTML=`<span>${files[i]}</span><span>安全</span>`;
                    scanDetails.appendChild(item);
                }
            }else{
                if(scanDetails.children.length===0){
                    cleanAlert.style.display='block';
                    systemClean.style.display='block';
                    rescanBtn.style.display='inline-block';
                    rescanBtn.disabled=false;
                    resetBtn.style.display='inline-block';
                }else{
                    criticalAlert.style.display='block';
                    if(hasInstalledCCNB){
                        fixBtn.style.display='inline-block';
                        startBtn.style.display='none';
                        resetBtn.style.display='inline-block';
                    }else{
                        ccnbRequired.style.display='block';
                        startBtn.style.display='none';
                        resetBtn.style.display='none';
                    }
                }
            }
        }

        function fixThreats(){
            fixBtn.disabled=true;
            fixBtn.innerHTML='<span class="loading"></span> 修复中...';
            alertText.textContent="正在清除安全威胁，请稍候...";
            setTimeout(()=>{
                localStorage.setItem('threatsFixed','true');
                scanDetails.innerHTML='';
                for(let i=0;i<files.length;i++){
                    const item=document.createElement('div');
                    item.className='file-item';
                    item.innerHTML=`<span>${files[i]}</span><span>安全</span>`;
                    scanDetails.appendChild(item);
                }
                criticalAlert.style.display='none';
                cleanAlert.style.display='block';
                systemClean.style.display='block';
                fixBtn.style.display='none';
                rescanBtn.style.display='inline-block';
                rescanBtn.disabled=false;
                resetBtn.style.display='inline-block';
            },2000);
        }

        function installCCNB(){
            if(activationKey.value!==CORRECT_KEY){
                alert('激活密钥错误，请输入正确的密钥！');
                return;
            }
            scannerUI.style.display='none';
            ccnbInstaller.style.display='block';
            let progressValue=0;
            let currentFile=0;
            const interval=setInterval(()=>{
                progressValue+=Math.random()*5;
                if(progressValue>100)progressValue=100;
                ccnbProgress.style.width=progressValue+'%';
                if(progressValue<20){
                    ccnbStatusText.textContent="准备安装组件...";
                }else if(progressValue<40){
                    ccnbStatusText.textContent="安装安全引擎...";
                }else if(progressValue<60){
                    ccnbStatusText.textContent="注册防护模块...";
                }else if(progressValue<80){
                    ccnbStatusText.textContent="更新威胁数据库...";
                }else{
                    ccnbStatusText.textContent="完成安全配置...";
                }
                if(currentFile<ccnbFiles.length&&Math.random()>0.7){
                    const fileItem=document.createElement('div');
                    fileItem.className='file-item';
                    fileItem.textContent=`正在安装: ${ccnbFiles[currentFile]}`;
                    ccnbFileProgress.appendChild(fileItem);
                    ccnbFileProgress.scrollTop=ccnbFileProgress.scrollHeight;
                    currentFile++;
                }
                if(progressValue===100){
                    clearInterval(interval);
                    ccnbCompleteBtn.style.display='inline-block';
                }
            },300);
        }

        function completeCCNBInstallation(){
            localStorage.setItem('ccnbInstalled','true');
            scannerUI.style.display='block';
            ccnbInstaller.style.display='none';
            criticalAlert.style.display='none';
            cleanAlert.style.display='none';
            systemClean.style.display='none';
            ccnbRequired.style.display='none';
            scanDetails.innerHTML='';
            startBtn.style.display='none';
            fixBtn.style.display='none';
            rescanBtn.style.display='none';
            resetBtn.style.display='none';
            refreshMessage.style.display='block';
        }
    </script>
</body>
</html>
